<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Lightpng : PNG optimization tool for game graphics" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Lightpng</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/shibukawa/lightpng">View on GitHub</a>

          <h1 id="project_title">Lightpng</h1>
          <h2 id="project_tagline">PNG optimization tool for game graphics</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/shibukawa/lightpng/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/shibukawa/lightpng/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>lightpng PNG optimization tool for game graphics</h1>

<h2>Purpose of This Tool</h2>

<p>PNG file processing tool to use for texture in game.</p>

<p>3D graphics API (OpenGL and DirectX) provides any efficiency texture formats
like RGBA5551, RGB565, RGBA444 and so on. They can save graphics' memory and
improve performance.</p>

<p>And current gaming API supports PNG file for texture. But PNG doesn't support
any 16 bit per pixel formats.</p>

<p>This program generates a color reducted PNG file with dithering and it uses
16 bit color space only. It generates high quality PNG files by using
<code>Floydâ€“Steinberg dithering &lt;http://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering&gt;</code>_
algorithm. So you can easy to create 16 bit texture from this file like it::</p>

<pre><code>// if it has no alpha channel
png_byte  src[height][width * 3];
uint16_t  texture[height * width];
for (size_t y = 0; y &lt; height; ++y)
{
    for (size_t x = 0; x &lt; width; ++x)
    {
        int r = src[y][x * 3];
        int g = src[y][x * 3];
        int b = src[y][x * 3];
        texture[y * width + x] = static_cast&lt;uint16_t&gt;((r &lt;&lt; 11) | (g &lt;&lt; 5) | (b));
    }
}
</code></pre>

<p>PNG is east to handle for developers and designers. And the result PNG file become
smaller than the original PNG file. It will help many mobile game developers.</p>

<p>ngCore already supports RGBA4444 and RGB565 format. You can create 16bit <code>GL2.Texture</code>
from this PNG file directly.</p>

<h2>How To Build</h2>

<p>It needs following libraries, but these source code are bundled:</p>

<ul>
<li>libpng</li>
<li>libz</li>
<li>jpeglib</li>
</ul><p>This repository contains a build setting file of SCons. I tested on Mac OS X with MaccPorts environment,
but maybe work on any scons/gcc environment::</p>

<p>$ sudo port install scons 
   $ scons
   $ ./lightpng input.png -16m output.png</p>

<p>If you have MinGW environment, you can build Win32 binary on your environment ::</p>

<p>$ sudo port install i386-mingw32-gcc scons
   $ soncs --mingw32
   $ wine lightpng.exe input.png -16m output.png</p>

<h2>Usage</h2>

<p>Use this command like this::</p>

<p>$ lightpng [opt] input_image [output_options]</p>

<p><code>input_image</code> can accept <code>.png</code> and <code>.jpg</code> file.</p>

<h3>Options</h3>

<p>:-s, --skip: Skip PNG file size optimization.
:-b, --benchmark: Display time to process.
:-v, --verbose: Display compression result.
:-h, --help: Show this message.</p>

<h3>Output Options</h3>

<p>:-16m PATH: 16 bit PNG with 1 bit alpha (RGBA 5551). If source image doesn't have alpha, it generates RGB 565 PNG.
:-16a PATH: 16 bit PNG with 4 bit alpha (RGBA 4444). If source image doesn't have alpha, it generates RGB 565 PNG.
:-16 PATH: It is as same as <code>-16a</code> .
:-32 PATH: 24/32 bit PNG. It tries several compression option and reduce file size.
:-p16m PATH: Preview mode of <code>-16m</code>.
:-p16a PATH: Preview mode of <code>-16a</code>.
:-p16 PATH: Preview mode of <code>-16</code>.</p>

<h2>Texture Mode / Preview Mode</h2>

<p>If you want to create final output, you should use texture mode.
But this file truncates unused bit, so it is not good for preview.</p>

<p>For example, RGBA 5551 format has only 1 bit for alpha channel. The solid color pixel's
alpha value become transparent.</p>

<p><strong>Before Convert</strong></p>

<p>.. list-table::</p>

<ul>
<li>* R

<ul>
<li><code>1100 0000</code></li>
</ul>
</li>
<li>* G

<ul>
<li><code>1111 1111</code></li>
</ul>
</li>
<li>* B

<ul>
<li><code>0000 1111</code></li>
</ul>
</li>
<li>* A

<ul>
<li><code>1111 1111</code></li>
</ul>
</li>
</ul><p><strong>After Convert</strong></p>

<p>.. list-table::</p>

<ul>
<li>* R

<ul>
<li><code>1100 0000</code></li>
</ul>
</li>
<li>* G

<ul>
<li><code>1111 1000</code></li>
</ul>
</li>
<li>* B

<ul>
<li><code>0000 1000</code></li>
</ul>
</li>
<li>* A

<ul>
<li><code>1000 0000</code></li>
</ul>
</li>
</ul><p>Preview mode completes the lack of this information. You can see final image on your favorite viewer.</p>

<h2>License</h2>

<p>This source code is released under MIT License.</p>

<h2>Non-Open Source Version</h2>

<p>This program experimentally supports compressed texture generation (pvr/atc). It needs PVRTexLib and/or AdrenoSDK. They are available here:</p>

<ul>
<li><a href="http://www.imgtec.com/powervr/insider/powervr-utilities.asp">http://www.imgtec.com/powervr/insider/powervr-utilities.asp</a></li>
<li><a href="http://developer.qualcomm.com/develop/">http://developer.qualcomm.com/develop/</a></li>
</ul><p>AdrenoSDK is proveded in Windows execution. So you need wine to install and extract needed libraries/headers.</p>

<p>To create this version, set following flags to scons command:</p>

<p>:--no-opensource: Enable Texture Compression format support
:--PVRTexLib=DIR: Enable PVRTC Texture Compression convert/preview feature. Default is "./PVRTexLib".
:--AdrenoSDK=DIR: Enable ATITC Texture Compression convert/preview feature. Default is "~/.wine/drive_c/AdrenoSDK".</p>

<p>It adds following output options:</p>

<p>:-pvr PATH: 4 bpp PVRTC compressed texture file
:-lpvr PATH: 4 bpp PVRTC compressed texture file with legacy format (version 2)
:-ppvr PATH: Preview mode of PVRTC
:-atc PATH: 8 bpp ATITC compressed texture file
:-fatc PATH: 8 bpp ATITC compressed texture file with header information
:-patc PATH: Preview mode of PVRTC</p>

<p>If you use this option, use this program for internal use. You can't distribute your modified source code and/or binary in public.
If you want to reuse my source code to your product, please sent me Amazon.com or Amazon.co.jp e-mail gift to my address (yoshiki at shibu.jp).</p>

<p>I am reading the license of Ardeno SDK, but it maybe prohibit linking with open source tool (legal English is very difficult). If I find any good way to link with open source code, I will merge this code into main.</p>

<p>.. note::</p>

<p><code>--no-opensource</code> and <code>--mingw32</code> can not be enabled at the same time now.
   Please anyone tell me how to use closed source .lib via mingw32.</p>

<h2>Author</h2>

<p>:Copyright: Yoshiki Shibukawa (DeNA Co.,Ltd. / ngmoco:) LLC)
:Contact: yshibukawa at ngmoco.com</p>

<h2>Thanks</h2>

<p>This source code is created by other many people's help. Including my family, friends of Python/Sphinx communitiy, coworkers (DeNA, ngmoco)
and so on.</p>

<p>I learned good dithering algorithm from Sc4Freak's blog (<a href="http://adtsai.blogspot.com/2011/03/high-quality-dithering-for-windows.html">http://adtsai.blogspot.com/2011/03/high-quality-dithering-for-windows.html</a>) and
his source code. My implementation is an improvement/portable version of his code.</p>

<p>And thanks from Greg Roelofs (libpng author) and Jean-loup Gailly and Mark Adler (zlib authors), I can implement it in a day.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Lightpng maintained by <a href="https://github.com/shibukawa">shibukawa</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
